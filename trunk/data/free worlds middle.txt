# Copyright (c) 2014 by Michael Zahniser
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.

mission "FW Diplomacy 1"
	landing
	name "Free Worlds Diplomacy"
	description "Travel to <planet> to meet up with Alondo, who will explain more."
	destination Longjump
	to offer
		has "event: navy occupying the south"
	
	on offer
		conversation
			`As you are landing, you receive a message from JJ, on behalf of the Council. The message reads:`
			`	Captain <last>, sorry that we have been out of contact. We need your help once again, to assist in a diplomatic mission. Please meet up with Alondo on <planet> as soon as possible. He will give you more information.`
			`			Sincerely,`
			`				Jean Jacques and Freya`
				accept
	
	on complete
		dialog `As you are landing, Alondo contacts you and asks you to meet him in the spaceport as soon as you have a bunk prepared for him.`



mission "FW Diplomacy 1B"
	name "Free Worlds Diplomacy"
	description "Bring Alondo to <planet> to meet with Parliament. Your guarantee of safe passage will expire on <day>."
	source Longjump
	destination Earth
	deadline 21
	to offer
		has "FW Diplomacy 1: done"
	
	on offer
		conversation
			`You meet up with Alondo, who insists on not telling you anything until you are safely back aboard your own ship. Once you have brought him to his room, he says, "Here's the deal. The Senate has been secretly reaching out to other worlds, and three of them have decided to join us: New Portland, Dancer, and New India."`
			choice
				`	"That's great news!"`
				`	"Why haven't I heard of this yet?"`
					goto heard
			`	"Indeed it is," says Alondo. "Any worlds joining us would be reason to celebrate, but these three are particularly important because they are on the trade route to Tarazed. If we control those systems, our supply convoys will be much safer."`
			`	"Why isn't this public knowledge yet?" you ask.`
			label heard
			`	"Well," says Alondo, "apparently the Senate was not being as secretive as they thought. Somehow word leaked out to the Republic that those worlds were defecting, and a massive Navy fleet moved to occupy those systems. Which means we're on the brink of another bloody battle."`
			choice
				`	"Don't worry, I'm sure we can defeat them."`
					goto defeat
				`	"Is there any way to avoid a fight?"`
					goto avoid
			label defeat
			`	"I'm sure we can," says Alondo, "but with heavy loss of life on both sides. We want to avoid that if at all possible. That's where you come in."`
				goto plan
			label avoid
			`	"That's what we're hoping," he says, "and that's where you come in."`
				goto plan
			label plan
			`	"How so?" you ask.`
			`	He says, "We've arranged for you to be granted safe passage through Republic space for the next three weeks. That's enough time to bring me to Earth and back. If I can meet with Parliament in person, maybe I will be able to work something out."`
			choice
				`	"Okay, let's go to Earth!"`
					accept
				`	"How do we know this isn't a trap? You're willing to risk your life for this?"`
			`	"If we can save thousands of lives from being lost in a needless battle, it's worth the risk," he says. "Now come on, the clock is ticking. We need to be safely back in Free space before your safe passage expires."`
				accept
	
	on accept
		event "fw safe passage starts"
		event "fw safe passage ends" 21



mission "FW Diplomacy 1C"
	landing
	name "Free Worlds Diplomacy"
	description "Bring Alondo to <planet> to meet with the senior Navy officers. Take as direct a route as possible, because your safe passage expires soon."
	source Earth
	destination "New Wales"
	clearance
	to offer
		has "FW Diplomacy 1B: done"
	
	on offer
		conversation
			`You drop off Alondo and wish him luck. Hours pass, and you begin to worry that he has been taken prisoner or killed. But finally he returns, looking very discouraged. "It makes no sense," he says. "The tax revenue they get from those three worlds doesn't come close to covering the cost of defending them. They should be glad to let them go."`
			choice
				`	"So, the Senate won't give up those worlds without a fight?"`
					goto fight
				`	"Maybe they're afraid of the precedent it would set if they give in to us."`
					goto precedent
			label fight
			`	"That's right," he says. "Amazing how heedless they can be, sitting in their comfy Parliament house deciding the fates of others."`
				goto next
			label precedent
			`	"Yes, that seems to be what's at stake," he says. "But by now they should see the writing on the wall. Amazing how callous they can be about the lives of the Navy crews who are following their orders."`
			label next
			`	"So, we just head home in defeat?" you ask.`
			`	"Not quite," he says. "While we have the chance, I want to talk with the Navy leadership directly. Landing near the secret base on New Austria would be way too provocative, so I've arranged to meet with them on their base on <planet> instead."`
			choice
				`	"Okay, if that's what it takes to avoid another bloody battle, I'll take you there."`
					accept
				`	"Are you insane? Flying straight into the largest Navy base in the sector?"`
			`	"Don't worry," he says. "The Navy takes honor very seriously. If they promise our safety, we'll be safe. At least until that grant of safe passage expires, that is." You have serious doubts, but you have no choice but to obey him.`
				accept



mission "FW Diplomacy 1D"
	landing
	name "Free Worlds Diplomacy"
	description "Bring Alondo back to <destination>. Take as direct a route as possible, because your safe passage expires soon."
	source "New Wales"
	destination Longjump
	to offer
		has "FW Diplomacy 1C: done"
	
	on offer
		conversation
			`When you land on <origin>, Alondo says, "You should join me for this meeting. You may find it eye-opening."`
			`	Four of the Navy generals who are stationed here have agreed to meet with you. You discover that one of them is from the Dirt Belt. Another grew up in the Rim, and admits to you that if he were not serving the Navy, he would be fighting for the Free Worlds. All four of them seem sympathetic to your cause, and express genuine regret not just for the Navy lives that have been lost, but for the Free Worlds losses as well.`
			`	And all four of them state, without any hesitation or equivocation, that if the Senate orders them to continue to fight the Free Worlds, they will fight until all possibility of victory is gone.`
			`	Alondo thanks them for their time and their honesty, and you return to your ship. "Well, it was worth a try. Now we just have to get home safely," he says.`
				accept
	
	on complete
		dialog `You are still finding it hard to believe that you made it to Earth and back in one piece. Alondo thanks you for transporting him and says, "Now I just have to break the bad news to the Senate. JJ and I will meet you in the spaceport bar in a few hours, once we've decided what our next steps will be."`
		event "navy using mark ii ships"



mission "FW Southern Recon 1"
	name "Reconnaissance"
	description "Fly through Rastaban, Delta Sagittarii, and Albaldah to get a sense of the Navy's strength in those systems, then report to <destination>."
	source Longjump
	waypoint Rastaban
	waypoint "Delta Sagittarii"
	waypoint Albaldah
	destination Trinket
	to offer
		has "FW Diplomacy 1D: done"
	
	on offer
		conversation
			`Alondo and JJ are in a somber mood when you meet up with them in the bar. You can't help remembering that Tomek always used to be a part of these gatherings, before he turned against the Senate. And now it looks like your next major battle will be fought without Tomek's expert guidance.`
			`	JJ says, "We've done all we can. Sooner or later we will have to fight the Navy for those star systems. So to start with, <first>, we'd like you to scout them out and report back to us on the Navy's presence there. Freya is on Trinket, gathering a fleet. Report to her there when you're done."`
				accept



mission "FW Southern Recon 1B"
	landing
	name "Electron Beam"
	description "Steal an Electron Beam from a Navy gunboat and return it to <planet> for Freya to look at. She thought your best bet for finding lone gunboats might be the Wei or Alnasl systems."
	source Trinket
	destination Trinket
	to offer
		has "FW Southern Recon 1: done"
	
	on offer
		event "gunboats in Alnasl"
		conversation
			`Freya thanks you for performing the scouting mission, and you give her a copy of your ship's logs to analyze. As she looks through them, almost immediately something catches her eye. "Looks like the Navy is fielding some new weapons," she says. "Some higher-yield torpedos, and a beam weapon even more powerful than heavy lasers. Those beam weapons in particular worry me."`
			choice
				`	"Yes, that kind of negates the advantage I was hoping we'd have due to our new plasma turrets."`
				`	"Does that mean we're not going to attack them after all?"`
					goto attack
			`	"Well," she says, "the plasma turrets weren't the only ace up our sleeve, but still, it's frustrating that the Navy still has such an advantage over us technologically."`
			`	"What should we do?" you ask.`
			label attack
			`	"We're going to have to fight them eventually, but first we need as much information as we can get on their new weapon systems. I'd like you to find one of their gunboats that has the new electron beams installed, steal one of them, and bring it back here. I imagine one of them can't be much bigger than twenty or thirty tons, so you ought to be able to find space for it. Think you can do that?"`
			choice
				`	"How can I find a gunboat that's all by itself? They're usually a part of a bigger fleet."`
			`	She thinks about that for a moment, then says, "The Navy has shifted most of their capital ships to the defecting systems in the south. That means that some of the systems up north will have lighter defenses. You might try Wei or Alnasl. Good luck, Captain."`
				accept
	
	on complete
		event "normal in Alnasl"
		outfit "Electron Beam" -1
		dialog `You hand off the Electron Beam to Freya's science team. They tell you that she's waiting for you in a cafe in the spaceport.`
